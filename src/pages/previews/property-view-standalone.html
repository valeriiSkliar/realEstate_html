<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="csrf-token" content="csrf-token" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</title>
  </head>
  <body>
    <app-header></app-header>
    <app-mobile-menu></app-mobile-menu>

    <main class="page-content">
      <div id="app">
        <div class="property-detail-page">
          <div class="featured-section">
            <!-- Breadcrumb -->
            <nav
              class="breadcrumb mb-3"
              aria-label="Breadcrumb navigation"
              role="navigation"
            >
              <ol class="breadcrumb-list">
                <li class="breadcrumb-item">
                  <a class="breadcrumb-link" href="/">–ì–ª–∞–≤–Ω–∞—è</a>
                </li>
                <li class="breadcrumb-item">
                  <a class="breadcrumb-link" href="/search.html">–ü–æ–∏—Å–∫</a>
                </li>
                <li class="breadcrumb-item active-page">
                  <span class="breadcrumb-text"
                    >–°—Ç—É–¥–∏—è, 65.6 –º¬≤ | –ß–µ—Ä–µ–º—É—à–∫–∏</span
                  >
                </li>
              </ol>
            </nav>
            <!-- End Breadcrumb -->
          </div>
          <div class="container-fluid px-0">
            <!-- Property Gallery -->
            <div class="property-gallery mb-4">
              <div class="gallery-container">
                <div class="gallery-thumbnails">
                  <div class="thumbnail-item active" data-index="0">
                    <img
                      src="images/property_view_example/1.jpg"
                      alt="Preview 1"
                    />
                  </div>
                  <div class="thumbnail-item" data-index="1">
                    <img
                      src="images/property_view_example/2.jpg"
                      alt="Preview 2"
                    />
                  </div>
                  <div class="thumbnail-item" data-index="2">
                    <img
                      src="images/property_view_example/3.jpg"
                      alt="Preview 3"
                    />
                  </div>
                  <div class="thumbnail-item" data-index="3">
                    <img
                      src="images/property_view_example/4.jpg"
                      alt="Preview 4"
                    />
                  </div>
                  <div class="thumbnail-item" data-index="4">
                    <img
                      src="images/property_view_example/5.jpg"
                      alt="Preview 5"
                    />
                  </div>
                  <div class="thumbnail-item" data-index="5">
                    <img
                      src="images/property_view_example/6.jpg"
                      alt="Preview 6"
                    />
                  </div>
                  <div class="thumbnail-item" data-index="6">
                    <img
                      src="images/property_view_example/7.jpg"
                      alt="Preview 7"
                    />
                  </div>
                </div>

                <div class="gallery-main">
                  <div class="main-image-container">
                    <button
                      class="gallery-nav-btn gallery-nav-prev"
                      id="gallery-prev"
                    >
                      <i class="bi bi-chevron-left"></i>
                    </button>
                    <div class="main-image-wrapper">
                      <img
                        id="main-gallery-image"
                        src="images/property_view_example/1.jpg"
                        class="main-image"
                        alt="3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞, 85 –º¬≤"
                        style="cursor: pointer"
                      />
                    </div>
                    <button
                      class="gallery-nav-btn gallery-nav-next"
                      id="gallery-next"
                    >
                      <i class="bi bi-chevron-right"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <!-- End Property Gallery -->
          </div>

          <div class="container-fluid px-0">
            <div class="property-detail-header">
              <h1 class="property-detail-header__title">
                –°—Ç—É–¥–∏—è, 65.6 –º¬≤ | –ß–µ—Ä–µ–º—É—à–∫–∏
              </h1>
              <button
                id="favorite-button"
                data-property-id="1"
                class="property-detail-header__favorite-btn"
                type="button"
                aria-label="–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"
              >
                <i class="bi bi-heart"></i>
              </button>
            </div>
          </div>
          <div class="property-detail-pricing">
            <div class="property-detail-pricing__main">
              <div class="price-block">
                <div class="price-block__main">‚ÇΩ 12 000 000</div>
                <div class="price-block__per-meter">127 000 ‚ÇΩ –∑–∞ –º¬≤</div>
              </div>
              <div class="agent-block">
                <div class="agent-block__name-block">
                  <div class="agent-block__label">–ê–≥–µ–Ω—Ç:</div>
                  <div class="agent-block__name">–ò–≤–∞–Ω</div>
                </div>
                <a href="tel:89182542536" class="agent-block__phone"
                  >+7 (918) 254-25-36</a
                >
              </div>
            </div>
          </div>

          <div class="property-detail-info">
            <div class="property-detail-info__main">
              <div class="property-info-block">
                <h2 class="property-info-block__complex-name">
                  –ñ–ö ¬´–°–æ–ª–Ω–µ—á–Ω—ã–π¬ª
                </h2>
                <div class="property-info-block__address">
                  –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä, —É–ª. –õ–µ–Ω–∏–Ω–∞, 126, –§–µ—Å—Ç–∏–≤–∞–ª—å–Ω—ã–π
                </div>
              </div>
              <div class="property-meta-block">
                <div class="property-meta-block__item">
                  <span class="property-meta-block__label">–û–±–Ω–æ–≤–ª–µ–Ω–æ:</span>
                  <span class="property-meta-block__value"
                    >—Å–µ–≥–æ–¥–Ω—è –≤ 10:45</span
                  >
                </div>
                <div class="property-meta-block__item">
                  <span class="property-meta-block__stats"
                    >1198 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤, 41 –∑–∞ —Å–µ–≥–æ–¥–Ω—è</span
                  >
                </div>
              </div>
            </div>
          </div>

          <div class="property-characteristics">
            <div class="property-characteristics__main">
              <h3 class="property-characteristics__title">–û –∫–≤–∞—Ä—Ç–∏—Ä–µ</h3>
              <div class="property-characteristics__grid">
                <div class="characteristic-item">
                  <span class="characteristic-item__label"
                    >–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–∞</span
                  >
                  <span class="characteristic-item__value">–ñ–ö ¬´–§–æ–Ω—Ç–∞–Ω—ã¬ª</span>
                </div>
                <div class="characteristic-item">
                  <span class="characteristic-item__label">–†–∞–π–æ–Ω</span>
                  <span class="characteristic-item__value">–ß–µ—Ä–µ–º—É—à–∫–∏ –º–∫—Ä.</span>
                </div>
                <div class="characteristic-item">
                  <span class="characteristic-item__label">–£–ª–∏—Ü–∞</span>
                  <span class="characteristic-item__value"
                    >–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∞—è —É–ª.</span
                  >
                </div>
                <div class="characteristic-item">
                  <span class="characteristic-item__label"
                    >–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç</span
                  >
                  <span class="characteristic-item__value">–°—Ç—É–¥–∏—è</span>
                </div>
                <div class="characteristic-item">
                  <span class="characteristic-item__label"
                    >–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å, –º¬≤</span
                  >
                  <span class="characteristic-item__value">65.60</span>
                </div>
                <div class="characteristic-item">
                  <span class="characteristic-item__label">–°–æ—Å—Ç–æ—è–Ω–∏–µ</span>
                  <span class="characteristic-item__value">–†–µ–º–æ–Ω—Ç</span>
                </div>
                <div class="characteristic-item">
                  <span class="characteristic-item__label">–≠—Ç–∞–∂</span>
                  <span class="characteristic-item__value">10</span>
                </div>
                <div class="characteristic-item">
                  <span class="characteristic-item__label">–¢–µ–ª–µ—Ñ–æ–Ω –∞–≥–µ–Ω—Ç–∞</span>
                  <a href="tel:89182542536" class="characteristic-item__value"
                    >8 918 254 25 36</a
                  >
                </div>
              </div>
              <h3 class="property-characteristics__description-title">
                –û–ø–∏—Å–∞–Ω–∏–µ
              </h3>
              <div
                class="property-characteristics__description"
                id="property-description"
              >
                <div class="description-full-text" style="display: none">
                  <p>
                    –†–∞–π–æ–Ω –ú–æ–ª–æ–¥–µ–∂–Ω—ã–π<br />
                    ‚óè 2-—è –¶–µ–ª–∏–Ω–æ–≥—Ä–∞–¥—Å–∫–∞—è 38/1<br />
                    ‚ñ∏1 –∫.–∫–≤. 6/6 –ö–∏—Ä–ø–∏—á<br />
                    –ü–ª–æ—â–∞–¥—å: 37–º<br />
                    *–¶–µ–Ω–∞: 3 200 000‚ÇΩ*<br />
                    –†–µ–º–æ–Ω—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ<br />
                    –û–±—Ä–µ–º: –Ω–µ—Ç. –†–∞–∑–±: 1700<br />
                    üí∞–í–∞—à–∏ —Å–≤–µ—Ä—Ö—É –º–æ–∂–Ω–æ –ª—é–±—ã–µ<br />
                    –°–≤—è–∑—å: 89385151639 –í–∞–ª–µ—Ä–∏–π<br />
                    (–ö–æ–¥: –∞–Ω–µ—Ñ)<br />
                    –§–æ—Ç–æ —Ç—É—Ç: disk.yandex.ru/d/c_kwDqdSy251yw<br />
                    ---<br />
                    –†–∞–π–æ–Ω –ú–æ–ª–æ–¥–µ–∂–Ω—ã–π<br />
                    ‚óè 2-—è –¶–µ–ª–∏–Ω–æ–≥—Ä–∞–¥—Å–∫–∞—è 38/1<br />
                    ‚ñ∏1 –∫.–∫–≤. 6/6 –ö–∏—Ä–ø–∏—á<br />
                    –ü–ª–æ—â–∞–¥—å: 43/18/11–º<br />
                    *–¶–µ–Ω–∞: 2 900 000‚ÇΩ*<br />
                    –ü—Ä–µ–¥—á–∏—Å—Ç–æ–≤–∞—è –æ—Ç–¥–µ–ª–∫–∞<br />
                    –ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ –Ω–∞ –¥–≤–µ —Å—Ç–æ—Ä–æ–Ω—ã<br />
                    –û–±—Ä–µ–º: –Ω–µ—Ç. –†–∞–∑–±: 1000<br />
                    üí∞–í–∞—à–∏ —Å–≤–µ—Ä—Ö—É –º–æ–∂–Ω–æ –¥–æ 50<br />
                    –°–≤—è–∑—å: 89385151639 –í–∞–ª–µ—Ä–∏–π<br />
                    (–ö–æ–¥: –µ–∫—Å–µ)<br />
                    –§–æ—Ç–æ —Ç—É—Ç: disk.yandex.ru/d/_y0pCcac1Vk3jg<br />
                    ---<br />
                    –†–∞–π–æ–Ω –ú–æ–ª–æ–¥–µ–∂–Ω—ã–∏ÃÜ<br />
                    ‚óè 2-—è –¶–µ–ª–∏–Ω–æ–≥—Ä–∞–¥—Å–∫–∞—è 38/3<br />
                    ‚ñ∏ 1 –∫. –∫–≤, 4/6 –ö–∏—Ä–ø–∏—á<br />
                    –ü–ª–æ—â–∞–¥—å: 44<br />
                    *–¶–µ–Ω–∞: 3 950 000 ‚ÇΩ*<br />
                    –†–µ–º–æ–Ω—Ç –Ω–æ–≤—ã–∏ÃÜ<br />
                    –û–±—Ä–µ–º: –Ω–µ—Ç. –†–∞–∑–±: –Ω–µ—Ç<br />
                    üí∞–í–∞—à–∏ —Å–≤–µ—Ä—Ö—É –º–æ–∂–Ω–æ –¥–æ 150<br />
                    –°–≤—è–∑—å: 89385151639 –í–∞–ª–µ—Ä–∏–π<br />
                    (–ö–æ–¥: —Å–µ—Ö—É)<br />
                    –§–æ—Ç–æ –Ω–µ—Ç<br />
                    ---
                  </p>
                </div>
                <div class="description-preview"></div>
              </div>
              <div
                class="property-characteristics__description-more"
                id="description-toggle"
              >
                <button
                  type="button"
                  class="property-characteristics__description-more-link"
                  id="description-toggle-btn"
                >
                  <span class="toggle-text">–ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ</span>
                  <i class="bi bi-chevron-down"></i>
                </button>
              </div>
            </div>
          </div>
          <div
            class="property-detail-page__buttons container-fluid px-0 mt-3 d-flex flex-column justify-content-center align-items-center gap-3"
          >
            <button
              class="brand-button brand-button--solid"
              id="add-to-collections-button"
              data-property-id="1"
            >
              –î–æ–±–∞–≤–∏—Ç—å –≤ –ø–æ–¥–±–æ—Ä–∫—É
            </button>
            <button
              class="brand-button brand-button--solid brand-button--turquoise"
              data-action="report"
            >
              –ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è
            </button>
          </div>
        </div>
      </div>
    </main>

    <!-- Image Modal -->
    <div id="imageModal" class="image-modal" aria-hidden="true">
      <div class="image-modal__overlay">
        <div class="image-modal__container">
          <button class="image-modal__close" type="button" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
            <i class="bi bi-x"></i>
          </button>

          <div class="image-modal__content">
            <button
              class="image-modal__nav image-modal__nav--prev"
              type="button"
              aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
            >
              <i class="bi bi-chevron-left"></i>
            </button>

            <div class="image-modal__image-container">
              <img id="modalImage" src="" alt="" class="image-modal__image" />
            </div>

            <button
              class="image-modal__nav image-modal__nav--next"
              type="button"
              aria-label="–°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
            >
              <i class="bi bi-chevron-right"></i>
            </button>
          </div>

          <div class="image-modal__counter">
            <span id="modalCounter">1 / 5</span>
          </div>
        </div>
      </div>
    </div>

    <app-footer></app-footer>

    <div class="collection-selector-popup-backdrop"></div>
    <div class="collection-selector-popup-container" id="collection-selector-popup"
    data-api-url-create-collection="/api/collections"
    data-api-url-add-property-to-collection="/api/collections/properties"
    data-api-url-remove-property-from-collection="/api/collections/properties"
    data-api-url-get-collections-with-property="/api/properties/properties/collections"
    >
      <div class="collection-selector-popup">
        <div class="collection-selector-popup__header">
          <h5 class="collection-selector-popup__title">–î–æ–±–∞–≤–∏—Ç—å –≤ –ø–æ–¥–±–æ—Ä–∫—É</h5>
          <button class="collection-selector-popup__close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
            <i class="bi bi-x-lg"></i>
          </button>
        </div>
        <div class="collection-selector-popup__body">
          <div class="collection-selector-popup__list-container">
                <div class="collection-selector-popup__empty">
                <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ–¥–±–æ—Ä–æ–∫.</p>
              </div>
              <div class="collection-selector-popup__list">
              </div>
          </div>
          <div class="collection-selector-popup__create-new-container" style="display: none;">
            <div class="form-group mb-3">
              <label for="newCollectionNameInput" class="form-label visually-hidden">–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –ø–æ–¥–±–æ—Ä–∫–∏</label>
              <input type="text" class="form-control" id="newCollectionNameInput" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –ø–æ–¥–±–æ—Ä–∫–∏">
            </div>
          </div>
        </div>
        <div class="collection-selector-popup__footer">
          <button class="btn btn-outline-secondary collection-selector-popup__create-new-btn">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é</button>
          <button class="btn btn-outline-brand-turquoise collection-selector-popup__cancel-btn">–û—Ç–º–µ–Ω–∞</button>
          <button class="btn btn-brand-lime collection-selector-popup__save-btn">–ì–æ—Ç–æ–≤–æ</button>
        </div>
      </div>
    </div>

    <div class="toast-container position-fixed bottom-0 end-0 p-3"></div>

    <script type="module">
      document.addEventListener("DOMContentLoaded", function () {
        // Gallery images data
        const galleryImages = [
          {
            src: "images/property_view_example/1.jpg",
            thumb: "images/property_view_example/1.jpg",
            alt: "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 1",
          },
          {
            src: "images/property_view_example/2.jpg",
            thumb: "images/property_view_example/2.jpg",
            alt: "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 2",
          },
          {
            src: "images/property_view_example/3.jpg",
            thumb: "images/property_view_example/3.jpg",
            alt: "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 3",
          },
          {
            src: "images/property_view_example/4.jpg",
            thumb: "images/property_view_example/4.jpg",
            alt: "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 4",
          },
          {
            src: "images/property_view_example/5.jpg",
            thumb: "images/property_view_example/5.jpg",
            alt: "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 5",
          },
          {
            src: "images/property_view_example/6.jpg",
            thumb: "images/property_view_example/6.jpg",
            alt: "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 5",
          },
          {
            src: "images/property_view_example/7.jpg",
            thumb: "images/property_view_example/7.jpg",
            alt: "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 5",
          },
        ];

        let currentImageIndex = 0;
        const mainImage = document.getElementById("main-gallery-image");
        const thumbnails = document.querySelectorAll(".thumbnail-item");
        const prevBtn = document.getElementById("gallery-prev");
        const nextBtn = document.getElementById("gallery-next");

        // Modal elements
        const imageModal = document.getElementById("imageModal");
        const modalImage = document.getElementById("modalImage");
        const modalCounter = document.getElementById("modalCounter");
        const modalCloseBtn = imageModal.querySelector(".image-modal__close");
        const modalOverlay = imageModal.querySelector(".image-modal__overlay");
        const modalPrevBtn = imageModal.querySelector(
          ".image-modal__nav--prev"
        );
        const modalNextBtn = imageModal.querySelector(
          ".image-modal__nav--next"
        );

        // Function to update main image
        function updateMainImage(index) {
          if (index < 0 || index >= galleryImages.length) return;

          currentImageIndex = index;
          mainImage.src = galleryImages[index].src;
          mainImage.alt = galleryImages[index].alt;

          // Update active thumbnail
          thumbnails.forEach((thumb, i) => {
            thumb.classList.toggle("active", i === index);
          });
        }

        // Modal functions
        function openModal(index) {
          if (index < 0 || index >= galleryImages.length) return;

          currentImageIndex = index;
          modalImage.src = galleryImages[index].src;
          modalImage.alt = galleryImages[index].alt;
          modalCounter.textContent = `${index + 1} / ${galleryImages.length}`;

          imageModal.classList.add("active");
          imageModal.setAttribute("aria-hidden", "false");
          document.body.style.overflow = "hidden"; // Prevent body scroll
        }

        function closeModal() {
          imageModal.classList.remove("active");
          imageModal.setAttribute("aria-hidden", "true");
          document.body.style.overflow = ""; // Restore body scroll
        }

        function updateModalImage(index) {
          if (index < 0 || index >= galleryImages.length) return;

          currentImageIndex = index;
          modalImage.src = galleryImages[index].src;
          modalImage.alt = galleryImages[index].alt;
          modalCounter.textContent = `${index + 1} / ${galleryImages.length}`;

          // Also update the main gallery
          updateMainImage(index);
        }

        // Main image click to open modal
        mainImage.addEventListener("click", () => {
          openModal(currentImageIndex);
        });

        // Modal navigation
        modalPrevBtn.addEventListener("click", () => {
          const newIndex =
            currentImageIndex > 0
              ? currentImageIndex - 1
              : galleryImages.length - 1;
          updateModalImage(newIndex);
        });

        modalNextBtn.addEventListener("click", () => {
          const newIndex =
            currentImageIndex < galleryImages.length - 1
              ? currentImageIndex + 1
              : 0;
          updateModalImage(newIndex);
        });

        // Modal close handlers
        modalCloseBtn.addEventListener("click", closeModal);

        // Improved modal overlay click handler
        imageModal.addEventListener("click", (e) => {
          // Close modal if clicked outside the image container
          if (
            !e.target.closest(".image-modal__container") ||
            e.target.classList.contains("image-modal__overlay")
          ) {
            console.log("closeModal");
            closeModal();
          }
        });

        // Prevent modal from closing when clicking on modal content
        const modalContainer = imageModal.querySelector(
          ".image-modal__container"
        );
        modalContainer.addEventListener("click", (e) => {
          e.stopPropagation();
        });

        // Thumbnail click handlers
        thumbnails.forEach((thumbnail, index) => {
          thumbnail.addEventListener("click", () => {
            updateMainImage(index);
          });
        });

        // Navigation buttons
        prevBtn.addEventListener("click", () => {
          const newIndex =
            currentImageIndex > 0
              ? currentImageIndex - 1
              : galleryImages.length - 1;
          updateMainImage(newIndex);
        });

        nextBtn.addEventListener("click", () => {
          const newIndex =
            currentImageIndex < galleryImages.length - 1
              ? currentImageIndex + 1
              : 0;
          updateMainImage(newIndex);
        });

        // Keyboard navigation
        document.addEventListener("keydown", (e) => {
          if (imageModal.classList.contains("active")) {
            // Modal is open
            if (e.key === "Escape") {
              closeModal();
            } else if (e.key === "ArrowLeft") {
              modalPrevBtn.click();
            } else if (e.key === "ArrowRight") {
              modalNextBtn.click();
            }
          } else {
            // Modal is closed, normal gallery navigation
            if (e.key === "ArrowLeft") {
              prevBtn.click();
            } else if (e.key === "ArrowRight") {
              nextBtn.click();
            }
          }
        });

        // Touch/Swipe navigation
        let touchStartX = 0;
        let touchEndX = 0;
        let touchStartY = 0;
        let touchEndY = 0;
        const minSwipeDistance = 50; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è –¥–ª—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Å–≤–∞–π–ø–∞
        const maxVerticalDistance = 100; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–≤–∞–π–ø–∞

        const mainImageWrapper = document.querySelector(".main-image-wrapper");

        if (mainImageWrapper) {
          // –ù–∞—á–∞–ª–æ –∫–∞—Å–∞–Ω–∏—è
          mainImageWrapper.addEventListener(
            "touchstart",
            (e) => {
              touchStartX = e.touches[0].clientX;
              touchStartY = e.touches[0].clientY;
            },
            { passive: true }
          );

          // –ö–æ–Ω–µ—Ü –∫–∞—Å–∞–Ω–∏—è
          mainImageWrapper.addEventListener(
            "touchend",
            (e) => {
              touchEndX = e.changedTouches[0].clientX;
              touchEndY = e.changedTouches[0].clientY;
              handleSwipe();
            },
            { passive: true }
          );
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–≤–∞–π–ø–∞
        function handleSwipe() {
          const deltaX = touchEndX - touchStartX;
          const deltaY = Math.abs(touchEndY - touchStartY);

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –¥–ª–∏–Ω—ã
          if (
            Math.abs(deltaX) > minSwipeDistance &&
            deltaY < maxVerticalDistance
          ) {
            if (deltaX > 0) {
              // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ - –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
              prevBtn.click();
            } else {
              // –°–≤–∞–π–ø –≤–ª–µ–≤–æ - —Å–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
              nextBtn.click();
            }
          }
        }

        // Modal touch events for mobile
        let modalTouchStartX = 0;
        let modalTouchStartY = 0;
        let modalTouchEndX = 0;
        let modalTouchEndY = 0;

        // Touch events for modal overlay to close on tap outside
        imageModal.addEventListener(
          "touchstart",
          (e) => {
            modalTouchStartX = e.touches[0].clientX;
            modalTouchStartY = e.touches[0].clientY;
          },
          { passive: true }
        );

        imageModal.addEventListener(
          "touchend",
          (e) => {
            modalTouchEndX = e.changedTouches[0].clientX;
            modalTouchEndY = e.changedTouches[0].clientY;

            // Check if it's a tap (not a swipe)
            const deltaX = Math.abs(modalTouchEndX - modalTouchStartX);
            const deltaY = Math.abs(modalTouchEndY - modalTouchStartY);
            const isTap = deltaX < 10 && deltaY < 10; // Small threshold for tap detection

            if (isTap && !e.target.closest(".image-modal__container")) {
              closeModal();
            }
          },
          { passive: true }
        );

        // Favorite button toggle
        const favoriteButton = document.querySelector(
          ".property-detail-header__favorite-btn"
        );
        if (favoriteButton) {
          favoriteButton.addEventListener("click", function () {
            const icon = this.querySelector("i");
            icon.classList.toggle("bi-heart");
            icon.classList.toggle("bi-heart-fill");
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å title
            if (icon.classList.contains("bi-heart-fill")) {
              this.title = "–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ";
              this.setAttribute("aria-label", "–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ");
            } else {
              this.title = "–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ";
              this.setAttribute("aria-label", "–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ");
            }
          });
        }
      });
    </script>
  </body>
</html>
